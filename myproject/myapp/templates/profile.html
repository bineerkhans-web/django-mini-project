<!DOCTYPE html>
<html lang="en">
	<head>
		{% load static %}
		<title>REAL ESTATE - Profile</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="{% static 'css/style.css' %}">
	</head>
	<body>
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<div class="container">
				<a class="navbar-brand" href="{% url 'myapp:home' %}">Stayhome</a>
			</div>
		</nav>
		<section class="ftco-section">
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-md-8">
						<h2 class="mb-4">Profile</h2>

						{% if messages %}
							{% for message in messages %}
								<div class="alert alert-{{ message.tags|default:'info' }}">
									{{ message }}
								</div>
							{% endfor %}
						{% endif %}

						<div class="card shadow-sm">
							<div class="card-body position-relative">
								<div class="text-right mb-2">
									{% if user.plan == 'free' %}
										<span class="badge badge-info">Current Plan: Free</span>
									{% elif user.plan == 'basic' %}
										<span class="badge badge-primary">Current Plan: Basic</span>
									{% elif user.plan == 'premium' %}
										<span class="badge badge-success">Current Plan: Premium</span>
									{% else %}
										<span class="badge badge-secondary">No Plan Selected</span>
									{% endif %}
								</div>
								<div class="text-center mb-4">
									{% if user.profile_picture %}
										<img src="{{ user.profile_picture.url }}" alt="Profile picture" class="rounded-circle" style="width:120px;height:120px;object-fit:cover;border:3px solid #f0f0f0;">
									{% else %}
										<img src="{% static 'images/person_1.jpg' %}" alt="Default profile picture" class="rounded-circle" style="width:120px;height:120px;object-fit:cover;border:3px solid #f0f0f0;">
									{% endif %}
								</div>
								<h5 class="card-title text-center">Account Information</h5>
								<ul class="list-unstyled mt-3 mb-4">
									<li><strong>Username:</strong> {{ user.username }}</li>
									<li>
										<strong>Email:</strong>
										{% if user.email %}
											{{ user.email }}
										{% else %}
											<span class="text-muted">Not provided</span>
										{% endif %}
									</li>
									<li>
										<strong>Phone:</strong>
										{% if user.phone %}
											{{ user.phone }}
										{% else %}
											<span class="text-muted">Not provided</span>
										{% endif %}
									</li>
									<li>
										<strong>Address:</strong>
										{% if user.address %}
											{{ user.address }}
										{% else %}
											<span class="text-muted">Not provided</span>
										{% endif %}
									</li>
								</ul>
								<a href="{% url 'myapp:signout' %}" class="btn btn-outline-secondary mr-2">Sign Out</a>
								<a href="{% url 'myapp:subscription' %}" class="btn btn-outline-primary mr-2">
									Subscription
								</a>
								<button type="button" class="btn btn-outline-secondary" data-toggle="modal" data-target="#profileUpdateModal">
 									Update
								</button>
								{% if user.plan == 'basic' or user.plan == 'premium' %}
									<a href="{% url 'secondapp:upload' %}" class="btn btn-outline-secondary">
										Upload
									</a>
								{% endif %}
								<a href="{% url 'secondapp:myplot' %}" class="btn btn-outline-secondary">
									My Plots
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<div class="modal fade" id="profileUpdateModal" tabindex="-1" role="dialog" aria-labelledby="profileUpdateModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
    					<h5 class="modal-title w-100 text-center" id="profileUpdateModalLabel">
        					Update Profile
    					</h5>
    					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
        					<span aria-hidden="true">&times;</span>
    					</button>
					</div>
					<form method="post" action="{% url 'myapp:profile' %}" enctype="multipart/form-data">
						{% csrf_token %}
						<div class="modal-body">
							<div class="form-group">
								<label for="username">Username</label>
								<input type="text" class="form-control" id="username" name="username" value="{{ user.username }}" required>
							</div>
							<div class="form-group">
								<label for="email">Email</label>
								<input type="email" class="form-control" id="email" name="email" value="{{ user.email }}">
							</div>
							<div class="form-group">
								<label for="phone">Phone</label>
								<input type="text" class="form-control" id="phone" name="phone" value="{{ user.phone }}">
							</div>
							<div class="form-group">
								<label for="address">Address</label>
								<input type="text" class="form-control" id="address" name="address" value="{{ user.address }}">
							</div>
							<div class="form-group">
								<label for="profilePicture">Profile Picture</label>
								<input type="file" class="form-control-file" id="profilePicture" name="profile_picture" accept="image/*">
								<small class="form-text text-muted">Upload a square image for best results.</small>
							</div>
							<hr>
							<p class="text-muted mb-2">Leave password fields blank to keep your current password.</p>
							<div class="form-group">
								<label for="password1">New Password</label>
								<input type="password" class="form-control" id="password1" name="password1">
							</div>
							<div class="form-group">
								<label for="password2">Confirm New Password</label>
								<input type="password" class="form-control" id="password2" name="password2">
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
							<button type="submit" class="btn btn-outline-secondary">Save Changes</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<script src="{% static 'js/jquery.min.js' %}"></script>
		<script src="{% static 'js/popper.min.js' %}"></script>
		<script src="{% static 'js/bootstrap.min.js' %}"></script>
		<script src="{% static 'js/main.js' %}"></script>
	</body>
</html>

